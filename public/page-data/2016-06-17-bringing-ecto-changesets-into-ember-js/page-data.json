{"componentChunkName":"component---src-templates-blog-post-tsx","path":"/2016-06-17-bringing-ecto-changesets-into-ember-js/","result":{"data":{"site":{"siteMetadata":{"title":"no.lol","author":"Azmarie Wang"}},"markdownRemark":{"id":"b4fdce4d-23ef-551c-a676-60193a609c25","excerpt":"The past month or so, I’ve been working on an Elixir and Phoenix API for a client. I am blown away by how nice it is working with Elixir and functional…","html":"<p>The past month or so, I’ve been working on an <a href=\"http://elixir-lang.org/\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">Elixir</a> and <a href=\"http://www.phoenixframework.org/\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">Phoenix</a> API for a client. I am blown away by how nice it is working with Elixir and functional programming (FP) concepts. FP feels more intuitive and less prone to “shoot yourself in the foot” scenarios compared to OOP. In fact, I try to use functional approaches wherever possible in JavaScript as well.</p>\n<p>That isn’t to say that one is better than the other, but in my experience less unexpected behavior occurs in FP. It turns out whole classes of bugs disappear when embracing immutability and pure functions.</p>\n<h4 id=\"ecto-changesets-to-the-rescue\" style=\"position:relative;\"><a href=\"#ecto-changesets-to-the-rescue\" aria-label=\"ecto changesets to the rescue permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Ecto Changesets to the Rescue</h4>\n<p>In Elixir, we use <a href=\"https://github.com/elixir-ecto/ecto\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">Ecto</a>, a DSL for writing queries and interacting with databases. One of the core concepts in Ecto is the <a href=\"https://hexdocs.pm/ecto/Ecto.Changeset.html\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">changeset</a> — an atomic collection of changes. Changes are validated and checked against database constraints (such as uniqueness) before casting. This ensures that we catch invalid data in the app layer before insertion into the database. Ecto is often confused with <a href=\"http://rubyonrails.org/\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">Rails</a>’ <a href=\"http://guides.rubyonrails.org/active_record_basics.html\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">ActiveRecord</a>, but it isn’t an ORM, and shouldn’t be used like one.</p>\n<p>The idea for bringing changesets into Ember occurred to me while I was working on a new client app. An edit page featured 3 forms, all bound to the same model. Each hidden form had separate “toggle”, “save” and “reset” actions. Using <a href=\"https://github.com/martndemus/ember-form-for\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">ember-form-for</a> and <a href=\"https://github.com/offirgolan/ember-cp-validations\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">ember-cp-validations</a>, this turned out to be harder than I thought. Editing one form would immediately update the model with 2-way bindings. This was a poor user experience, since you might edit more than 1 form at a time, but want to separate saves and resets.</p>\n<h4 id=\"changesets-in-ember\" style=\"position:relative;\"><a href=\"#changesets-in-ember\" aria-label=\"changesets in ember permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Changesets in Ember</h4>\n<p>In my mind, I could see a solution using changesets. Each form would have a separate changeset, so changes (and validations) would be independent. It turns out that this approach works really well, and I’m happy to announce that you can <a href=\"https://github.com/poteto/ember-changeset\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">install it today as an addon</a> with:</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">ember install ember-changeset\nember install ember-changeset-validations</code></pre></div>\n<p>I wrote the addon with compatibility in mind, so it’s easy to wire up with your favorite validation library. The simplest way to incorporate validations is to use <a href=\"https://github.com/poteto/ember-changeset-validations/\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">ember-changeset-validations</a>, a companion addon. It has a simple mental model, and there are no observers or CPs involved — just pure, plain JavaScript functions.</p>\n<p>Let’s take a look at how <a href=\"https://github.com/poteto/ember-changeset\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">ember-changeset</a> is implemented, and we’ll also demonstrate how they align with Ember’s Data Down Actions Up (DDAU) philosophy.</p>\n<h4 id=\"virtual-properties-with-unknownproperty-and-setunknownproperty\" style=\"position:relative;\"><a href=\"#virtual-properties-with-unknownproperty-and-setunknownproperty\" aria-label=\"virtual properties with unknownproperty and setunknownproperty permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Virtual Properties with unknownProperty and setUnknownProperty</h4>\n<p>The core concept behind ember-changeset is the definition of <code class=\"language-text\">unknownProperty</code> and <code class=\"language-text\">setUnknownProperty</code>. These methods are invoked (if present) in <code class=\"language-text\">Ember.get</code> or <code class=\"language-text\">Ember.set</code> whenever an Ember Object does not define a property. Ruby developers would be familiar with this behavior via the <code class=\"language-text\">method_missing</code> method. A colleague I used to work with wrote an excellent <a href=\"https://emberway.io/metaprogramming-in-emberjs-627921395299#.8m07o1i8u\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">blog post</a> on this topic, please check it out if you’re interested in finding out more!</p>\n<p>For example:</p>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre class=\"language-js\"><code class=\"language-js\"><span class=\"token keyword\">let</span> Person <span class=\"token operator\">=</span> EmberObject<span class=\"token punctuation\">.</span><span class=\"token function\">extend</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span>\n  firstName<span class=\"token operator\">:</span> <span class=\"token keyword\">null</span><span class=\"token punctuation\">,</span>\n  lastName<span class=\"token operator\">:</span> <span class=\"token keyword\">null</span><span class=\"token punctuation\">,</span>\n\n  <span class=\"token function\">unknownProperty</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">key</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    console<span class=\"token punctuation\">.</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span><span class=\"token template-string\"><span class=\"token template-punctuation string\">`</span><span class=\"token string\">Could not get </span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">${</span>key<span class=\"token interpolation-punctuation punctuation\">}</span></span><span class=\"token string\">!</span><span class=\"token template-punctuation string\">`</span></span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n\n  <span class=\"token function\">setUnknownProperty</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">key<span class=\"token punctuation\">,</span> value</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    console<span class=\"token punctuation\">.</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span><span class=\"token template-string\"><span class=\"token template-punctuation string\">`</span><span class=\"token string\">Could not set </span><span class=\"token template-punctuation string\">`</span></span>$<span class=\"token punctuation\">{</span>key<span class=\"token punctuation\">}</span> <span class=\"token keyword\">with</span> $<span class=\"token punctuation\">{</span>value<span class=\"token punctuation\">}</span><span class=\"token operator\">!</span>`<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code></pre></div>\n<p>When a <code class=\"language-text\">Person</code> is created, trying to <code class=\"language-text\">get</code> or <code class=\"language-text\">set</code> a property other than <code class=\"language-text\">firstName</code> and <code class=\"language-text\">lastName</code> will invoke the <code class=\"language-text\">unknownProperty</code> and <code class=\"language-text\">setUnknownProperty</code> methods respectively:</p>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre class=\"language-js\"><code class=\"language-js\"><span class=\"token keyword\">let</span> jim <span class=\"token operator\">=</span> Person<span class=\"token punctuation\">.</span><span class=\"token function\">create</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span> firstName<span class=\"token operator\">:</span> <span class=\"token string\">'Jim'</span><span class=\"token punctuation\">,</span> lastName<span class=\"token operator\">:</span> <span class=\"token string\">'Bob'</span> <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\njim<span class=\"token punctuation\">.</span><span class=\"token function\">get</span><span class=\"token punctuation\">(</span><span class=\"token string\">'firstName'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span> <span class=\"token comment\">// \"Jim\"</span>\njim<span class=\"token punctuation\">.</span><span class=\"token function\">get</span><span class=\"token punctuation\">(</span><span class=\"token string\">'fullName'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span> <span class=\"token comment\">// \"Could not get fullName!\"</span>\njim<span class=\"token punctuation\">.</span><span class=\"token function\">set</span><span class=\"token punctuation\">(</span><span class=\"token string\">'age'</span><span class=\"token punctuation\">,</span> <span class=\"token number\">25</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span> <span class=\"token comment\">// \"Could not set age with 25!\"</span></code></pre></div>\n<p>These two methods allow us to <em>proxy</em> our changeset to the actual model, meaning we can hold back changes but still forward <code class=\"language-text\">get</code>s to the model.</p>\n<h4 id=\"storing-changes\" style=\"position:relative;\"><a href=\"#storing-changes\" aria-label=\"storing changes permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Storing Changes</h4>\n<p>Our changeset needs a reference to the underlying model, as well as an internal list of changes to be applied. We can set this up in the <code class=\"language-text\">init</code> method of our object, which is invoked whenever a new instance is created.</p>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre class=\"language-js\"><code class=\"language-js\"><span class=\"token keyword\">export</span> <span class=\"token keyword\">function</span> <span class=\"token function\">changeset</span><span class=\"token punctuation\">(</span>obj<span class=\"token punctuation\">,</span> validateFn<span class=\"token comment\">/*, validationMap */</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">return</span> EmberObject<span class=\"token punctuation\">.</span><span class=\"token function\">extend</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span>\n    <span class=\"token function\">init</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n      <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span><span class=\"token function\">_super</span><span class=\"token punctuation\">(</span><span class=\"token operator\">...</span>arguments<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n      <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>_content <span class=\"token operator\">=</span> obj<span class=\"token punctuation\">;</span>\n      <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>_changes <span class=\"token operator\">=</span> <span class=\"token punctuation\">{</span><span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span>\n      <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>_errors <span class=\"token operator\">=</span> <span class=\"token punctuation\">{</span><span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span>\n      <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>_validator <span class=\"token operator\">=</span> validateFn<span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span>\n\n<span class=\"token keyword\">export</span> <span class=\"token keyword\">default</span> <span class=\"token keyword\">class</span> <span class=\"token class-name\">Changeset</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token function\">constructor</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">return</span> <span class=\"token function\">changeset</span><span class=\"token punctuation\">(</span><span class=\"token operator\">...</span>arguments<span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">create</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>We want to be able to forward <code class=\"language-text\">get</code>s to <code class=\"language-text\">_content</code>, but hold back <code class=\"language-text\">set</code>s on <code class=\"language-text\">_changes</code>, and this is easy enough to set up via virtual properties:</p>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre class=\"language-js\"><code class=\"language-js\"><span class=\"token punctuation\">{</span>\n  <span class=\"token function\">unknownProperty</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">key</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">let</span> content <span class=\"token operator\">=</span> <span class=\"token function\">get</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">this</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'_content'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">return</span> <span class=\"token function\">get</span><span class=\"token punctuation\">(</span>content<span class=\"token punctuation\">,</span> key<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n\n  <span class=\"token function\">setUnknownProperty</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">key<span class=\"token punctuation\">,</span> value</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">return</span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span><span class=\"token function\">_validateAndSet</span><span class=\"token punctuation\">(</span>key<span class=\"token punctuation\">,</span> value<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n\n  <span class=\"token function\">_validateAndSet</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">key<span class=\"token punctuation\">,</span> value</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token comment\">// if valid, set it on `_changes`</span>\n    <span class=\"token comment\">// otherwise set it on `_errors`</span>\n  <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>Since a changeset should only allow valid changes to be set, we validate the change using the <code class=\"language-text\">validateFn</code> function that was passed in to the changeset factory. If a change is valid, we add it to the hash of changes in <code class=\"language-text\">_changes</code>, and if it’s invalid and returns an error message, we add it to the hash of <code class=\"language-text\">_errors</code>.</p>\n<p>Of course, there are more implementation details than that, but the concept remains unchanged. After defining a simple public API for using changesets, there wasn’t too much more code to add! For example, this is how you would use a changeset:</p>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre class=\"language-js\"><code class=\"language-js\"><span class=\"token keyword\">let</span> changeset <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">Changeset</span><span class=\"token punctuation\">(</span>user<span class=\"token punctuation\">,</span> validatorFn<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\nuser<span class=\"token punctuation\">.</span><span class=\"token function\">get</span><span class=\"token punctuation\">(</span><span class=\"token string\">'firstName'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span> <span class=\"token comment\">// \"Michael\"</span>\nuser<span class=\"token punctuation\">.</span><span class=\"token function\">get</span><span class=\"token punctuation\">(</span><span class=\"token string\">'lastName'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span> <span class=\"token comment\">// \"Bolton\"</span>\n\nchangeset<span class=\"token punctuation\">.</span><span class=\"token function\">set</span><span class=\"token punctuation\">(</span><span class=\"token string\">'firstName'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'Jim'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\nchangeset<span class=\"token punctuation\">.</span><span class=\"token function\">set</span><span class=\"token punctuation\">(</span><span class=\"token string\">'lastName'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'B'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\nchangeset<span class=\"token punctuation\">.</span><span class=\"token function\">get</span><span class=\"token punctuation\">(</span><span class=\"token string\">'isInvalid'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span> <span class=\"token comment\">// true</span>\nchangeset<span class=\"token punctuation\">.</span><span class=\"token function\">get</span><span class=\"token punctuation\">(</span><span class=\"token string\">'errors'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span> <span class=\"token comment\">// [{ key: 'lastName', validation: 'too short', value: 'B' }]</span>\nchangeset<span class=\"token punctuation\">.</span><span class=\"token function\">set</span><span class=\"token punctuation\">(</span><span class=\"token string\">'lastName'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'Bob'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\nchangeset<span class=\"token punctuation\">.</span><span class=\"token function\">get</span><span class=\"token punctuation\">(</span><span class=\"token string\">'isValid'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span> <span class=\"token comment\">// true</span>\n\nuser<span class=\"token punctuation\">.</span><span class=\"token function\">get</span><span class=\"token punctuation\">(</span><span class=\"token string\">'firstName'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span> <span class=\"token comment\">// \"Michael\"</span>\nuser<span class=\"token punctuation\">.</span><span class=\"token function\">get</span><span class=\"token punctuation\">(</span><span class=\"token string\">'lastName'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span> <span class=\"token comment\">// \"Bolton\"</span>\n\nchangeset<span class=\"token punctuation\">.</span><span class=\"token function\">save</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span> <span class=\"token comment\">// sets and saves valid changes on the user</span>\nuser<span class=\"token punctuation\">.</span><span class=\"token function\">get</span><span class=\"token punctuation\">(</span><span class=\"token string\">'firstName'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span> <span class=\"token comment\">// \"Jim\"</span>\nuser<span class=\"token punctuation\">.</span><span class=\"token function\">get</span><span class=\"token punctuation\">(</span><span class=\"token string\">'lastName'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span> <span class=\"token comment\">// \"Bob\"</span></code></pre></div>\n<p>Rolling back changes, and even merging them, becomes trivial with a changeset:</p>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre class=\"language-js\"><code class=\"language-js\">changeset<span class=\"token punctuation\">.</span><span class=\"token function\">set</span><span class=\"token punctuation\">(</span><span class=\"token string\">'firstName'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'Milton'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\nchangeset<span class=\"token punctuation\">.</span><span class=\"token function\">get</span><span class=\"token punctuation\">(</span><span class=\"token string\">'isDirty'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span> <span class=\"token comment\">// true</span>\nchangeset<span class=\"token punctuation\">.</span><span class=\"token function\">rollback</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\nchangeset<span class=\"token punctuation\">.</span><span class=\"token function\">get</span><span class=\"token punctuation\">(</span><span class=\"token string\">'isDirty'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span> <span class=\"token comment\">// false</span></code></pre></div>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre class=\"language-js\"><code class=\"language-js\"><span class=\"token keyword\">let</span> changesetA <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">Changeset</span><span class=\"token punctuation\">(</span>user<span class=\"token punctuation\">,</span> validatorFn<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">let</span> changesetB <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">Changeset</span><span class=\"token punctuation\">(</span>user<span class=\"token punctuation\">,</span> validatorFn<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\nchangesetA<span class=\"token punctuation\">.</span><span class=\"token function\">set</span><span class=\"token punctuation\">(</span><span class=\"token string\">'firstName'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'Jim'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\nchangesetB<span class=\"token punctuation\">.</span><span class=\"token function\">set</span><span class=\"token punctuation\">(</span><span class=\"token string\">'firstName'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'Jimmy'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\nchangesetB<span class=\"token punctuation\">.</span><span class=\"token function\">set</span><span class=\"token punctuation\">(</span><span class=\"token string\">'lastName'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'Fallon'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">let</span> changesetC <span class=\"token operator\">=</span> changesetA<span class=\"token punctuation\">.</span><span class=\"token function\">merge</span><span class=\"token punctuation\">(</span>changesetB<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\nchangesetC<span class=\"token punctuation\">.</span><span class=\"token function\">execute</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\nuser<span class=\"token punctuation\">.</span><span class=\"token function\">get</span><span class=\"token punctuation\">(</span><span class=\"token string\">'firstName'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span> <span class=\"token comment\">// \"Jimmy\"</span>\nuser<span class=\"token punctuation\">.</span><span class=\"token function\">get</span><span class=\"token punctuation\">(</span><span class=\"token string\">'lastName'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span> <span class=\"token comment\">// \"Fallon\"</span></code></pre></div>\n<h4 id=\"data-down-actions-up-not-2-way-bindings\" style=\"position:relative;\"><a href=\"#data-down-actions-up-not-2-way-bindings\" aria-label=\"data down actions up not 2 way bindings permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Data Down Actions Up, Not 2-Way Bindings</h4>\n<p>One of the reasons DDAU is so strongly emphasized in Ember 2.x is because it helps us avoid shooting ourselves in the foot with 2 way bindings (2WBs). 2WBs were the “killer feature” of many JavaScript frameworks when they first debuted. As client side applications matured and became more sophisticated, developers realized that 2WBs were more harmful than useful. 2WBs led to instability and difficult debugging in the form of cascading changes, and <a href=\"https://facebook.github.io/react/\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">React</a> was the first library to attempt to solve this problem.</p>\n<p>React’s breakthrough was in the use of a virtual DOM, a representation of the actual DOM as a tree-like data structure. Diffing the changes between the virtual and real DOM paved the way for the complete removal of 2WBs — the application simply re-renders whenever there is a change in value.</p>\n<p>This continues to be a simpler mental model, and just like Elixir (and other functional languages), eliminates a whole class of bugs. DDAU in Ember.js is built upon the same idea, that data should flow one way.</p>\n<p>Using changesets in Ember takes the DDAU philosophy used in rendering into the realm of interacting with client side view models. Instead of 2WBs, changesets allow one way data flow to a model, ensuring that they are always valid, and eliminating a whole class of synchronization headaches.</p>\n<h4 id=\"is-this-real-life\" style=\"position:relative;\"><a href=\"#is-this-real-life\" aria-label=\"is this real life permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Is This Real Life?</h4>\n<p>When I dropped in <code class=\"language-text\">ember-changeset</code> and <code class=\"language-text\">ember-changeset-validations</code> into my client app, it instantly clicked with the way I’ve been writing Ember, using DDAU. My complex forms now have independent validations and changes, and I no longer need to worry about saving an unintended change in one form when I submit another.</p>\n<p>Because <code class=\"language-text\">ember-changeset</code> can be used directly in place of an ember-data model, using it with a form library like <code class=\"language-text\">ember-form-for</code> is trivial using the <code class=\"language-text\">changeset</code> helper:</p>\n<div class=\"gatsby-highlight\" data-language=\"handlebars\"><pre class=\"language-handlebars\"><code class=\"language-handlebars\"><span class=\"token handlebars language-handlebars\"><span class=\"token delimiter punctuation\">{{</span><span class=\"token variable\">dummy-form</span> <span class=\"token variable\">changeset</span><span class=\"token punctuation\">=</span><span class=\"token punctuation\">(</span><span class=\"token variable\">changeset</span> <span class=\"token variable\">model</span> <span class=\"token punctuation\">(</span><span class=\"token variable\">action</span> <span class=\"token string\">\"validate\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token delimiter punctuation\">}}</span></span></code></pre></div>\n<div class=\"gatsby-highlight\" data-language=\"handlebars\"><pre class=\"language-handlebars\"><code class=\"language-handlebars\"><span class=\"token handlebars language-handlebars\"><span class=\"token delimiter punctuation\">{{</span><span class=\"token block keyword\">#form-for</span> <span class=\"token variable\">changeset</span> <span class=\"token variable\">as</span> <span class=\"token punctuation\">|</span><span class=\"token variable\">f</span><span class=\"token punctuation\">|</span><span class=\"token delimiter punctuation\">}}</span></span>\n  <span class=\"token handlebars language-handlebars\"><span class=\"token delimiter punctuation\">{{</span><span class=\"token variable\">f</span><span class=\"token punctuation\">.</span><span class=\"token variable\">text-field</span> <span class=\"token string\">\"firstName\"</span><span class=\"token delimiter punctuation\">}}</span></span>\n  <span class=\"token handlebars language-handlebars\"><span class=\"token delimiter punctuation\">{{</span><span class=\"token variable\">f</span><span class=\"token punctuation\">.</span><span class=\"token variable\">text-field</span> <span class=\"token string\">\"lastName\"</span><span class=\"token delimiter punctuation\">}}</span></span>\n  <span class=\"token handlebars language-handlebars\"><span class=\"token delimiter punctuation\">{{</span><span class=\"token variable\">f</span><span class=\"token punctuation\">.</span><span class=\"token variable\">date-field</span> <span class=\"token string\">\"birthDate\"</span><span class=\"token delimiter punctuation\">}}</span></span>\n\n  <span class=\"token handlebars language-handlebars\"><span class=\"token delimiter punctuation\">{{</span><span class=\"token variable\">f</span><span class=\"token punctuation\">.</span><span class=\"token variable\">submit</span> <span class=\"token string\">\"Save\"</span><span class=\"token delimiter punctuation\">}}</span></span>\n<span class=\"token handlebars language-handlebars\"><span class=\"token delimiter punctuation\">{{</span><span class=\"token block keyword\">/form-for</span><span class=\"token delimiter punctuation\">}}</span></span></code></pre></div>\n<h4 id=\"validating-changesets\" style=\"position:relative;\"><a href=\"#validating-changesets\" aria-label=\"validating changesets permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Validating Changesets</h4>\n<p>Validation becomes even simpler with changesets. Throughout Ember’s history, we have largely relied on addons like <a href=\"https://github.com/DockYard/ember-validations\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">ember-validations</a> which make extensive use of observers. Newer libraries like <a href=\"https://github.com/offirgolan/ember-cp-validations\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">ember-cp-validations</a> use computed properties (CPs) instead, but that still relies on 2WBs.</p>\n<p>Using <code class=\"language-text\">ember-changeset</code> and <code class=\"language-text\">ember-changeset-validations</code> you can take a functional approach with validations. A validator function is passed into the changeset, that is invoked whenever a property is set. This validator function then looks up the appropriate validator (say <code class=\"language-text\">presence</code> or <code class=\"language-text\">format</code>) on the validation map, and returns <code class=\"language-text\">true</code> or an error message.</p>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre class=\"language-js\"><code class=\"language-js\"><span class=\"token keyword\">import</span> <span class=\"token punctuation\">{</span>\n  validatePresence<span class=\"token punctuation\">,</span>\n  validateLength<span class=\"token punctuation\">,</span>\n  validateConfirmation<span class=\"token punctuation\">,</span>\n  validateFormat\n<span class=\"token punctuation\">}</span> <span class=\"token keyword\">from</span> <span class=\"token string\">'ember-changeset-validations/validators'</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">import</span> validateCustom <span class=\"token keyword\">from</span> <span class=\"token string\">'../validators/custom'</span><span class=\"token punctuation\">;</span> <span class=\"token comment\">// local validator</span>\n<span class=\"token keyword\">import</span> validatePasswordStrength <span class=\"token keyword\">from</span> <span class=\"token string\">'../validators/password-strength'</span><span class=\"token punctuation\">;</span> <span class=\"token comment\">// local validator</span>\n\n<span class=\"token keyword\">export</span> <span class=\"token keyword\">default</span> <span class=\"token punctuation\">{</span>\n  firstName<span class=\"token operator\">:</span> <span class=\"token punctuation\">[</span>\n    <span class=\"token function\">validatePresence</span><span class=\"token punctuation\">(</span><span class=\"token boolean\">true</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>\n    <span class=\"token function\">validateLength</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span> min<span class=\"token operator\">:</span> <span class=\"token number\">4</span> <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span>\n  <span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span>\n  lastName<span class=\"token operator\">:</span> <span class=\"token function\">validatePresence</span><span class=\"token punctuation\">(</span><span class=\"token boolean\">true</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>\n  age<span class=\"token operator\">:</span> <span class=\"token function\">validateCustom</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span> foo<span class=\"token operator\">:</span> <span class=\"token string\">'bar'</span> <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>\n  email<span class=\"token operator\">:</span> <span class=\"token function\">validateFormat</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span> type<span class=\"token operator\">:</span> <span class=\"token string\">'email'</span> <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>\n  password<span class=\"token operator\">:</span> <span class=\"token punctuation\">[</span>\n    <span class=\"token function\">validateLength</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span> min<span class=\"token operator\">:</span> <span class=\"token number\">8</span> <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>\n    <span class=\"token function\">validatePasswordStrength</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span> minScore<span class=\"token operator\">:</span> <span class=\"token number\">80</span> <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span>\n  <span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span>\n  passwordConfirmation<span class=\"token operator\">:</span> <span class=\"token function\">validateConfirmation</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span> on<span class=\"token operator\">:</span> <span class=\"token string\">'password'</span> <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span></code></pre></div>\n<p>A validator like <code class=\"language-text\">validatePresence</code> is simply a function that returns a function:</p>\n<div class=\"gatsby-code-title\">validators/custom.js</div>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre class=\"language-js\"><code class=\"language-js\"><span class=\"token keyword\">export</span> <span class=\"token keyword\">default</span> <span class=\"token keyword\">function</span> <span class=\"token function\">validateCustom</span><span class=\"token punctuation\">(</span><span class=\"token parameter\"><span class=\"token punctuation\">{</span> foo<span class=\"token punctuation\">,</span> bar <span class=\"token punctuation\">}</span> <span class=\"token operator\">=</span> <span class=\"token punctuation\">{</span><span class=\"token punctuation\">}</span></span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">return</span> <span class=\"token punctuation\">(</span><span class=\"token parameter\">key<span class=\"token punctuation\">,</span> newValue<span class=\"token punctuation\">,</span> oldValue<span class=\"token punctuation\">,</span> changes</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n    <span class=\"token comment\">// validation logic</span>\n    <span class=\"token comment\">// return `true` if valid || error message string if invalid</span>\n  <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>Which is simpler to reason about compared to an OOP implementation that relies on extending base classes and holding on to state. Because validation maps are simply POJOs, composing validators is intuitive:</p>\n<div class=\"gatsby-code-title\">validations/user.js</div>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre class=\"language-js\"><code class=\"language-js\"><span class=\"token keyword\">import</span> <span class=\"token punctuation\">{</span>\n  validatePresence<span class=\"token punctuation\">,</span>\n  validateLength\n<span class=\"token punctuation\">}</span> <span class=\"token keyword\">from</span> <span class=\"token string\">'ember-changeset-validations/validators'</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">export</span> <span class=\"token keyword\">default</span> <span class=\"token punctuation\">{</span>\n  firstName<span class=\"token operator\">:</span> <span class=\"token function\">validatePresence</span><span class=\"token punctuation\">(</span><span class=\"token boolean\">true</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>\n  lastName<span class=\"token operator\">:</span> <span class=\"token function\">validatePresence</span><span class=\"token punctuation\">(</span><span class=\"token boolean\">true</span><span class=\"token punctuation\">)</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span></code></pre></div>\n<p>You can easily import other validations and combine them using <code class=\"language-text\">Ember.assign</code> or <code class=\"language-text\">Ember.merge</code>.</p>\n<div class=\"gatsby-code-title\">validations/adult.js</div>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre class=\"language-js\"><code class=\"language-js\"><span class=\"token keyword\">import</span> Ember <span class=\"token keyword\">from</span> <span class=\"token string\">'ember'</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">import</span> UserValidations <span class=\"token keyword\">from</span> <span class=\"token string\">'./user'</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">import</span> <span class=\"token punctuation\">{</span> validateNumber <span class=\"token punctuation\">}</span> <span class=\"token keyword\">from</span> <span class=\"token string\">'ember-changeset-validations/validators'</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">const</span> <span class=\"token punctuation\">{</span> assign <span class=\"token punctuation\">}</span> <span class=\"token operator\">=</span> Ember<span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">export</span> <span class=\"token keyword\">const</span> AdultValidations <span class=\"token operator\">=</span> <span class=\"token punctuation\">{</span>\n  age<span class=\"token operator\">:</span> <span class=\"token function\">validateNumber</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span> gt<span class=\"token operator\">:</span> <span class=\"token number\">18</span> <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">export</span> <span class=\"token keyword\">default</span> <span class=\"token function\">assign</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span><span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span> UserValidations<span class=\"token punctuation\">,</span> AdultValidations<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code></pre></div>\n<p>This approach lets you build up validations independent of the model. Ember Data models aren’t 1 to 1 representations of server-side records, they’re View Models. This means we shouldn’t need to validate them the same way we would a server-side model. For example, you might have <code class=\"language-text\">User</code> models in your application, and some of these users might have different roles that require different validation. Best of all, we don’t need to use observers or CPs!</p>\n<h4 id=\"the-only-constant-is-change\" style=\"position:relative;\"><a href=\"#the-only-constant-is-change\" aria-label=\"the only constant is change permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>The Only Constant is Change</h4>\n<p>I hope you enjoyed reading about the concept and implementation of changesets in Ember. DDAU on your models will make your life simpler and your app easier to reason about! Work is still on-going on these addons, so please try them out and let me know if you have any issues or feedback.</p>\n<p>As always, thanks for reading!</p>","timeToRead":9,"fields":{"slug":"/2016-06-17-bringing-ecto-changesets-into-ember-js/"},"frontmatter":{"title":"Bringing Ecto Changesets into Ember.js","shortDate":"June 17, 2016","longDate":"June 17, 2016, 11:47:26 pm","description":"The past month or so, I’ve been working on an Elixir and Phoenix API for a client. I am blown away by how nice it is working with Elixir…","categories":["engineering"],"cover":{"childImageSharp":{"fluid":{"base64":"data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAANABQDASIAAhEBAxEB/8QAGAAAAwEBAAAAAAAAAAAAAAAAAAIDAQX/xAAVAQEBAAAAAAAAAAAAAAAAAAADAv/aAAwDAQACEAMQAAABkr6aVOaUf//EABoQAQEAAgMAAAAAAAAAAAAAAAIBAAMREiL/2gAIAQEAAQUCetJebt7mThSvWUa7n//EABkRAAMAAwAAAAAAAAAAAAAAAAABEQIhUf/aAAgBAwEBPwHFrdKuH//EABQRAQAAAAAAAAAAAAAAAAAAABD/2gAIAQIBAT8BP//EAB0QAAICAQUAAAAAAAAAAAAAAAERAAISECIxQbH/2gAIAQEABj8Cqa22+QoJQMHiPKZ96f/EABsQAQACAwEBAAAAAAAAAAAAAAEAESExQVFh/9oACAEBAAE/IcQpxYtxaPYmVfBEMYBqtzaR1CuGp//aAAwDAQACAAMAAAAQZM//xAAZEQACAwEAAAAAAAAAAAAAAAAAAREhMfD/2gAIAQMBAT8Qbcm9YorH/8QAFxEBAQEBAAAAAAAAAAAAAAAAAQARIf/aAAgBAgEBPxBEDLt//8QAGxABAQADAQEBAAAAAAAAAAAAAREAIUExYcH/2gAIAQEAAT8Qt0MNZ+4ekxfSYGt8sMTPgjYmTb1vMcv7moloQ6bkSgPAdGf/2Q==","aspectRatio":1.5,"src":"/static/828d3013d9f77a40d1bc907808e0555e/7f945/steven-su-1405584-unsplash-optimized.jpg","srcSet":"/static/828d3013d9f77a40d1bc907808e0555e/e2788/steven-su-1405584-unsplash-optimized.jpg 360w,\n/static/828d3013d9f77a40d1bc907808e0555e/7d509/steven-su-1405584-unsplash-optimized.jpg 720w,\n/static/828d3013d9f77a40d1bc907808e0555e/7f945/steven-su-1405584-unsplash-optimized.jpg 1440w,\n/static/828d3013d9f77a40d1bc907808e0555e/47dad/steven-su-1405584-unsplash-optimized.jpg 2160w,\n/static/828d3013d9f77a40d1bc907808e0555e/af56c/steven-su-1405584-unsplash-optimized.jpg 2880w,\n/static/828d3013d9f77a40d1bc907808e0555e/93dd1/steven-su-1405584-unsplash-optimized.jpg 6240w","sizes":"(max-width: 1440px) 100vw, 1440px"}}},"coverAuthor":"Steven Su","coverOriginalUrl":"https://unsplash.com/photos/7Oc33M8vs0s?utm_source=unsplash&utm_medium=referral&utm_content=creditCopyText","keywords":["elixir","ecto","emberjs","changesets","ember-changeset","ember-changeset-validations","functional validations","virtual properties","method missing"],"published":true}}},"pageContext":{"slug":"/2016-06-17-bringing-ecto-changesets-into-ember-js/","previous":{"fields":{"slug":"/2016-04-21-declarative-templating-in-ember-with-composable-helpers/"},"frontmatter":{"title":"Declarative Templating in Ember with Composable Helpers"}},"next":{"fields":{"slug":"/2016-06-28-component-dependency-injection-in-ember-js/"},"frontmatter":{"title":"Component dependency injection in Ember.js"}}}},"staticQueryHashes":["3009088689","63159454"]}